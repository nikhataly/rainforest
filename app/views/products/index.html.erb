<!-- <h1>Products#index</h1>
<p>Find me in app/views/products/index.html.erb</p>
 -->

<h1>Products</h1>

<%= link_to "Back to Products", '/products  ' %><br>

<%= link_to "New Product", "/products/new" %>

<br>
<br>




<%= form_tag products_path, method: :get, authentication: false, id: 'search-form' do %>
  <%= text_field_tag :search, params[:search] %>
  <%= submit_tag "Search"%>
<% end %>

<br>
<br>

<div id="products" class ="container">

<% @products.each do |product| %>
  <%#= render @products %>
  <%= render partial: "product", locals: {product: product} %>
<% end %>

</div>

<script type="text/javascript">

  function display_search_results() {
    if (this.readyState === 4) {
      console.log(this);
      document.getElementById('products').innerHTML = this.responseText;
    }
  }

  var form = document.getElementById('search-form');
  form.addEventListener('submit', function(event) {
    event.preventDefault();
    var searchValue = document.getElementById('search').value;

    var xhr = new XMLHttpRequest();
    xhr.onload = display_search_results;
    xhr.open('GET', '/products?search=' + searchValue, true);
    xhr.setRequestHeader("X-Requested-With", "XMLHTTPRequest");
    xhr.send();
    // // alert('hello');


    // XMLHTTPRequest.new("http://whatever/", function(data) { })
  });

</script>